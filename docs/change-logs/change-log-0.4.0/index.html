<!doctype html><html lang=en data-bs-theme=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=preload as=font href=https://wldt.github.io/fonts/vendor/jost/jost-v4-latin-regular.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://wldt.github.io/fonts/vendor/jost/jost-v4-latin-500.woff2 type=font/woff2 crossorigin><link rel=preload as=font href=https://wldt.github.io/fonts/vendor/jost/jost-v4-latin-700.woff2 type=font/woff2 crossorigin><script src=https://wldt.github.io/js/color-mode.86a91f050a481d0a3f0c72ac26543cb6228c770875981c58dcbc008fd3f875c8.js integrity="sha256-hqkfBQpIHQo/DHKsJlQ8tiKMdwh1mBxY3LwAj9P4dcg="></script>
<link rel=stylesheet href=https://wldt.github.io/main.98d23aa7dd660b0233b98b24d30523cee5fd41cfb982ee4b0a6bb8b34fb55ea28ace95aed41ea24c82c4057ab1cc4255fea9bbc7a77a05defea9ed01fb7324c0.css integrity="sha512-mNI6p91mCwIzuYsk0wUjzuX9Qc+5gu5LCmu4s0+1XqKKzpWu1B6iTILEBXqxzEJV/qm7x6d6Bd7+qe0B+3MkwA==" crossorigin=anonymous><noscript><style>img.lazyload{display:none}</style></noscript><title>Change Log 0.4.0 | WLDT</title><meta property="canonical" content="https://wldt.github.io/docs/change-logs/change-log-0.4.0/"><meta name=description content="New Features WldtEventObserver A new class called WldtEventObserver has been introduced to allow a simplified observation of target specific events generated by the Digital Twin and its components such as adapters and the model."><meta property="robots" content="index, follow"><meta property="og:url" content="https://wldt.github.io/docs/change-logs/change-log-0.4.0/"><meta property="og:title" content="Change Log 0.4.0"><meta property="og:locale" content="en"><meta property="og:site_name" content="WLDT"><meta property="og:type" content="website"><meta property="og:section" content="docs"><meta property="og:description" content="New Features WldtEventObserver A new class called WldtEventObserver has been introduced to allow a simplified observation of target specific events generated by the Digital Twin and its components such as adapters and the model."><meta property="og:see_also" content="https://wldt.github.io/docs/introduction/dt-model/"><meta property="og:see_also" content="https://wldt.github.io/docs/introduction/dt-life-cycle/"><meta property="og:see_also" content="https://wldt.github.io/docs/introduction/library-structure-basic-concepts/"><meta property="og:see_also" content="https://wldt.github.io/docs/guides/physical-adapter/"><meta property="og:see_also" content="https://wldt.github.io/docs/guides/shadowing-function/"><meta property="og:see_also" content="https://wldt.github.io/docs/guides/digital-adapter/"><meta name=twitter:card content="summary"><meta name=twitter:title content="Change Log 0.4.0"><meta name=twitter:description content="New Features WldtEventObserver A new class called WldtEventObserver has been introduced to allow a simplified observation of target specific events generated by the Digital Twin and its components such as adapters and the model."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://wldt.github.io/","name":"White Label Digital Twins","position":1},{"@type":"ListItem","item":"https://wldt.github.io/docs/","name":"Docs","position":2},{"@type":"ListItem","item":"https://wldt.github.io/docs/change-logs/","name":"Change Logs","position":3},{"@type":"ListItem","name":"Change Log 0.4.0","position":4}]}</script><meta name=theme-color content><link rel=icon href=https://wldt.github.io/favicon.ico sizes=any><link rel=icon type=image/svg+xml href=https://wldt.github.io/favicon.svg><link rel=apple-touch-icon sizes=180x180 href=https://wldt.github.io/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=https://wldt.github.io/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://wldt.github.io/favicon-16x16.png><link rel=manifest crossorigin=use-credentials href=https://wldt.github.io/site.webmanifest></head><body class="single section docs" data-bs-spy=scroll data-bs-target=#toc data-bs-root-margin="0px 0px -60%" data-bs-smooth-scroll=true tabindex=0><div class=sticky-top><header class="navbar navbar-expand-lg"><div class=container-lg><a class="navbar-brand me-auto me-lg-3" href=https://wldt.github.io/>WLDT</a>
<button type=button id=searchToggleMobile class="btn btn-link nav-link mx-2 d-lg-none" aria-label="Search website"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button>
<button class="btn btn-link d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavSection aria-controls=offcanvasNavSection aria-label="Open section navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-dots-vertical" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 19m-1 0a1 1 0 102 0 1 1 0 10-2 0"/><path d="M12 5m-1 0a1 1 0 102 0 1 1 0 10-2 0"/></svg></button><div class="offcanvas offcanvas-start d-lg-none" tabindex=-1 id=offcanvasNavSection aria-labelledby=offcanvasNavSectionLabel><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavSectionLabel>Docs</h5><button type=button class="btn btn-link nav-link p-0" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class=offcanvas-body><aside class="doks-sidebar mt-n3"><nav id=doks-docs-nav aria-label="Tertiary navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-0b79795d3efc95b9976c7c5b933afce2 aria-expanded=false>
Introduction</button><div class=collapse id=section-0b79795d3efc95b9976c7c5b933afce2><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://wldt.github.io/docs/introduction/library-structure-basic-concepts/>Library Structure & Basic Concepts</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/introduction/dt-model/>DT Model</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/introduction/dt-life-cycle/>DT Life Cycle</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/introduction/dt-events/>DT Events</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-bf647454e36069fd16f1a7a35cf6a865 aria-expanded=false>
Getting Started</button><div class=collapse id=section-bf647454e36069fd16f1a7a35cf6a865><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/physical-adapter/>Physical Adapter</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/shadowing-function/>Shadowing Function</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/digital-adapter/>Digital Adapter</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/dt-engine-dt-instance/>DT Engine & DT Instance</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/digital-actions/>Digital Actions</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/dt-relationships/>DT Relationships</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/configurable-adapters/>Configurable Adapters</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/storage-layer/>Storage Layer</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-89413bd312d0909efb85e6693f36cb89 aria-expanded=false>
Adapters</button><div class=collapse id=section-89413bd312d0909efb85e6693f36cb89><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://wldt.github.io/docs/adapters/mqtt-physical-adapter/>MQTT Physical Adapter</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/adapters/mqtt-digital-adapter/>MQTT Digital Adapter</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/adapters/http-digital-adapter/>HTTP Digital Adapter</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3978929206deee2c125a1d732aae5545 aria-expanded=true>
Change Logs</button><div class="collapse show" id=section-3978929206deee2c125a1d732aae5545><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://wldt.github.io/docs/change-logs/change-log-0.3.0/>Change Log 0.3.0</a></li><li><a class="docs-link rounded active" href=https://wldt.github.io/docs/change-logs/change-log-0.4.0/>Change Log 0.4.0</a></li></ul></div></li></ul></nav></aside></div></div><button class="btn btn-link nav-link mx-2 order-3 d-lg-none" type=button data-bs-toggle=offcanvas data-bs-target=#offcanvasNavMain aria-controls=offcanvasNavMain aria-label="Open main navigation menu"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><line x1="4" y1="8" x2="20" y2="8"/><line x1="4" y1="16" x2="20" y2="16"/></svg></button><div class="offcanvas offcanvas-end h-auto" tabindex=-1 id=offcanvasNavMain aria-labelledby=offcanvasNavMainLabel><div class=offcanvas-header><h5 class=offcanvas-title id=offcanvasNavMainLabel>WLDT</h5><button type=button class="btn btn-link nav-link p-0" data-bs-dismiss=offcanvas aria-label=Close><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-x" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6 6 18"/><path d="M6 6l12 12"/></svg></button></div><div class="offcanvas-body d-flex flex-column flex-lg-row justify-content-between"><ul class="navbar-nav flex-grow-1"><li class=nav-item><a class=nav-link href=https://wldt.github.io/docs/introduction/library-structure-basic-concepts/>Documentation</a></li><li class=nav-item><a class=nav-link href=https://wldt.github.io/blog/>Blog</a></li><li class=nav-item><a class=nav-link href=https://wldt.github.io/about/>About</a></li></ul><button type=button id=searchToggleDesktop class="btn btn-link nav-link p-2 d-none d-lg-block" aria-label="Search website"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg></button>
<button id=buttonColorMode class="btn btn-link mx-auto nav-link p-0 ms-lg-2 me-lg-1" type=button aria-label="Toggle theme"><svg data-bs-theme-value="dark" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 3c.132.0.263.0.393.0a7.5 7.5.0 007.92 12.446A9 9 0 1112 2.992z"/></svg><svg data-bs-theme-value="light" xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-4 0a4 4 0 108 0 4 4 0 10-8 0m-5 0h1m8-9v1m8 8h1m-9 8v1M5.6 5.6l.7.7m12.1-.7-.7.7m0 11.4.7.7m-12.1-.7-.7.7"/></svg></button><ul id=socialMenu class="nav mx-auto flex-row order-lg-4"><li class=nav-item><a class="nav-link social-link" href=https://github.com/wldt><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg><small class="ms-2 visually-hidden">GitHub</small></a></li></ul></div></div></div></header></div><div class=modal id=searchModal tabindex=-1 aria-labelledby=searchModalLabel aria-hidden=true><div class="modal-dialog modal-dialog-scrollable modal-fullscreen-md-down"><div class=modal-content><div class=modal-header><h1 class="modal-title fs-5 visually-hidden" id=searchModalLabel>Search</h1><button type=button class="btn-close visually-hidden" data-bs-dismiss=modal aria-label=Close></button><div class="search-input flex-grow-1 d-none"><form id=search-form class=search-form action=# method=post accept-charset=utf-8 role=search><label for=query class=visually-hidden>Search</label><div class=d-flex><input type=search id=query name=query class="search-text form-control form-control-lg" placeholder=Search aria-label=Search maxlength=128 autocomplete=off>
<button type=button class="btn btn-link text-decoration-none px-0 ms-3 d-md-none" data-bs-dismiss=modal aria-label=Close>Cancel</button></div></form></div></div><div class=modal-body><p class="search-loading status message d-none mt-3 text-center">Loading search index…</p><p class="search-no-recent message d-none mt-3 text-center">No recent searches</p><p class="search-no-results message d-none mt-3 text-center">No results for "<strong><span class=query-no-results>Query here</span></strong>"</p><div id=searchResults class=search-results></div><template><article class="search-result list-view"><div class="card my-3"><div class=card-body><header><h2 class="h5 title title-submitted mb-0"><a class="stretched-link text-decoration-none text-reset" href=#>Title here</a></h2><div class="submitted d-none"><time class=created-date>Date here</time></div></header><div class=content>Summary here</div></div></div></article></template></div><div class=modal-footer><ul class="list-inline me-auto d-none d-md-block"><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Enter key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M12 3.53088v3c0 1-1 2-2 2H4m3 3-3-3 3-3"/></g></svg></kbd><span class=DocSearch-Label>to select</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Arrow down" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 3.5v8m3-3-3 3-3-3"/></g></svg></kbd><kbd class=me-2><svg width="15" height="15" aria-label="Arrow up" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M7.5 11.5v-8m3 3-3-3-3 3"/></g></svg></kbd><span class=DocSearch-Label>to navigate</span></li><li class=list-inline-item><kbd class=me-2><svg width="15" height="15" aria-label="Escape key" role="img"><g fill="none" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"><path d="M13.6167 8.936c-.1065.3583-.6883.962-1.4875.962-.7993.0-1.653-.9165-1.653-2.1258v-.5678c0-1.2548.7896-2.1016 1.653-2.1016s1.3601.4778 1.4875 1.0724M9 6c-.1352-.4735-.7506-.9219-1.46-.8972-.7092.0246-1.344.57-1.344 1.2166s.4198.8812 1.3445.9805C8.465 7.3992 8.968 7.9337 9 8.5s-.454 1.398-1.4595 1.398C6.6593 9.898 6 9 5.963 8.4851m-1.4748.5368c-.2635.5941-.8099.876-1.5443.876s-1.7073-.6248-1.7073-2.204v-.4603c0-1.0416.721-2.131 1.7073-2.131.9864.0 1.6425 1.031 1.5443 2.2492h-2.956"/></g></svg></kbd><span class=DocSearch-Label>to close</span></li></ul><p class=d-md-none>Search by <a class=text-decoration-none href=https://github.com/nextapps-de/flexsearch>FlexSearch</a></p></div></div></div></div><div class="wrap container-lg" role=document><div class=content><div class="row flex-xl-nowrap"><div class="col-lg-5 col-xl-4 docs-sidebar d-none d-lg-block"><nav class=docs-links aria-label="Main navigation"><ul class="list-unstyled collapsible-sidebar"><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-0b79795d3efc95b9976c7c5b933afce2 aria-expanded=false>
Introduction</button><div class=collapse id=section-0b79795d3efc95b9976c7c5b933afce2><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://wldt.github.io/docs/introduction/library-structure-basic-concepts/>Library Structure & Basic Concepts</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/introduction/dt-model/>DT Model</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/introduction/dt-life-cycle/>DT Life Cycle</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/introduction/dt-events/>DT Events</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-bf647454e36069fd16f1a7a35cf6a865 aria-expanded=false>
Getting Started</button><div class=collapse id=section-bf647454e36069fd16f1a7a35cf6a865><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/physical-adapter/>Physical Adapter</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/shadowing-function/>Shadowing Function</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/digital-adapter/>Digital Adapter</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/dt-engine-dt-instance/>DT Engine & DT Instance</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/digital-actions/>Digital Actions</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/dt-relationships/>DT Relationships</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/configurable-adapters/>Configurable Adapters</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/guides/storage-layer/>Storage Layer</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-89413bd312d0909efb85e6693f36cb89 aria-expanded=false>
Adapters</button><div class=collapse id=section-89413bd312d0909efb85e6693f36cb89><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://wldt.github.io/docs/adapters/mqtt-physical-adapter/>MQTT Physical Adapter</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/adapters/mqtt-digital-adapter/>MQTT Digital Adapter</a></li><li><a class="docs-link rounded" href=https://wldt.github.io/docs/adapters/http-digital-adapter/>HTTP Digital Adapter</a></li></ul></div></li><li class=mb-1><button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle=collapse data-bs-target=#section-3978929206deee2c125a1d732aae5545 aria-expanded=true>
Change Logs</button><div class="collapse show" id=section-3978929206deee2c125a1d732aae5545><ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small"><li><a class="docs-link rounded" href=https://wldt.github.io/docs/change-logs/change-log-0.3.0/>Change Log 0.3.0</a></li><li><a class="docs-link rounded active" href=https://wldt.github.io/docs/change-logs/change-log-0.4.0/>Change Log 0.4.0</a></li></ul></div></li></ul></nav></div><nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation"><div class=page-links><h3>Index</h3><nav id=toc><ul><li><a href=#new-features>New Features</a><ul><li><a href=#wldteventobserver>WldtEventObserver</a></li><li><a href=#storage-layer>Storage Layer</a></li></ul></li><li><a href=#migration-info-030---040>Migration Info: 0.3.0 - 0.4.0</a></li><li><a href=#additional-improvements--fixed-bugs>Additional Improvements & Fixed Bugs</a></li></ul></nav></div></nav><main class="docs-content col-lg-11 col-xl-9"><nav aria-label=breadcrumb><ol class=breadcrumb><li class=breadcrumb-item><a href=https://wldt.github.io/>Home</a></li><li class=breadcrumb-item><a href=https://wldt.github.io/docs/>Docs</a></li><li class=breadcrumb-item><a href=https://wldt.github.io/docs/change-logs/>Change Logs</a></li><li class="breadcrumb-item active" aria-current=page>Change Log 0.4.0</li></ol></nav><h1>Change Log 0.4.0</h1><nav class="toc-mobile d-xl-none" aria-label="Quaternary navigation"><details><summary>On this page</summary><div class=page-links><nav id=TableOfContents><ul><li><a href=#new-features>New Features</a><ul><li><a href=#wldteventobserver>WldtEventObserver</a></li><li><a href=#storage-layer>Storage Layer</a></li></ul></li><li><a href=#migration-info-030---040>Migration Info: 0.3.0 - 0.4.0</a></li><li><a href=#additional-improvements--fixed-bugs>Additional Improvements & Fixed Bugs</a></li></ul></nav></div></details></nav><h2 id=new-features>New Features<a href=#new-features class=anchor aria-hidden=true>#</a></h2><h3 id=wldteventobserver>WldtEventObserver<a href=#wldteventobserver class=anchor aria-hidden=true>#</a></h3><p>A new class called <code>WldtEventObserver</code> has been introduced to allow a simplified observation of target specific events generated by the Digital Twin and its components such as adapters and the model. Main mapped events and filters are:</p><ul><li>State Events: State Update and State Event Notifications</li><li>Physical Asset Events: Physical Property Variation, Physical Event Notification, Physical Relationship Instance Creation and Deletion</li><li>Physical Asset Action Events: Physical Action Trigger</li><li>Digital Action Events: Digital Action Event</li><li>Physical Asset Description Events: Physical Asset Description Available and Updated</li><li>Life Cycle Events: Digital Twin Life Cycle Events</li><li>Query Request Events: Storage Query Request Events (See next sections for additional information)</li></ul><p>For each event type dedicated observation and un-observation methods (e.g., <code>observePhysicalAssetEvents()</code> and <code>unObservePhysicalAssetEvents()</code>) are available in order to create an instance of the observer and decide which events to receive.</p><p>To build a <code>WldtEventObserver</code> a dedicated listener <code>IWldtEventObserverListener</code> should be implemented by the developer to receive the callbacks related to the incoming events. All the events are of the generic type <code>WldtEvent</code> and it is up to the developer the validate and check the received object and if it match with the expected one.</p><p>An example of usage for the event observer is the following:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>WldtEventObserver</span> <span class=n>eventObserver</span> <span class=o>=</span> <span class=k>new</span> <span class=n>WldtEventObserver</span><span class=o>(</span>  
</span></span><span class=line><span class=cl>        <span class=s>&#34;DT_TEST_ID_1&#34;</span><span class=o>,</span>  
</span></span><span class=line><span class=cl>        <span class=s>&#34;test-observer&#34;</span><span class=o>,</span>  
</span></span><span class=line><span class=cl>        <span class=n>myObserverListener</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=c1>// Start all the available observation  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>eventObserver</span><span class=o>.</span><span class=na>observePhysicalAssetEvents</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=n>eventObserver</span><span class=o>.</span><span class=na>observePhysicalAssetActionEvents</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=n>eventObserver</span><span class=o>.</span><span class=na>observeStateEvents</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=n>eventObserver</span><span class=o>.</span><span class=na>observeDigitalActionEvents</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=n>eventObserver</span><span class=o>.</span><span class=na>observePhysicalAssetDescriptionEvents</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=n>eventObserver</span><span class=o>.</span><span class=na>observeLifeCycleEvents</span><span class=o>();</span>
</span></span></code></pre></div><p>The <code>WldtEventObserver</code> has been currently used internally within the library to simplify the implementation and usage of the Storage Layer and the associated Storage Query System as described in the dedicated sections.</p><h3 id=storage-layer>Storage Layer<a href=#storage-layer class=anchor aria-hidden=true>#</a></h3><p>A new storage layer has been integrated into the core WLDT library, enabling Digital Twins (DTs) to store data related to the evolution of their state, generated events, and any variations involving properties, events, actions, relationships, and life cycle. The Storage Layer consists of two main components:</p><ul><li><strong>Storage Manager</strong>: This is the central component of the storage system, facilitating the structured and modular storage and retrieval of information. It allows developers to create and utilize various storage systems (e.g., in-memory, file-based, or DBMS) simultaneously. The Storage Layer is accessible in both read and write modes internally by the DT&rsquo;s Model, and in read-only mode via the Query System by Digital Adapters.</li><li><strong>Query System</strong>: To delegate and encapsulate the responsibility of data storage within the DT&rsquo;s model, a query system has been integrated. This system enables Digital Adapters to retrieve stored data and expose it according to their specific logic and implementation.</li></ul><p>The storage layer is designed for easy extension, allowing developers to create and share new storage layers (e.g., using Redis, MySQL, or MongoDB). The provided in-memory implementation serves <em>only</em> for basic development and testing purposes. Similarly, the Query Manager can be extended and customized by developers to implement additional query management features or to enhance the default functionalities provided by the library.</p><h4 id=storage-manager>Storage Manager<a href=#storage-manager class=anchor aria-hidden=true>#</a></h4><p>The main module of the Storage Layer is the one associated to Storage Capabilities and it is composed by two main classes: <code>StorageManager</code> and <code>WldStorage</code> with the following characteristics and main methods:</p><ul><li><code>StorageManager</code>: The StorageManager class is a class that represents the storage manager for a DigitalTwin. It is responsible for managing the storage of the data related to the DigitalTwin. It is an observer of the <code>WldtEventBus</code>, and it is able to save the data in the available storages. The class extends a <code>DigitalTwinWorker</code>, in order to allow the component to work in a structure and integrated way on a different thread that the core of a DT can coordinate starting and stopping it when required. The manager allow the usage of different storage systems at the same time in order to allow the developers to memorize the information accordingly to their need in the right storage system at the same time (e.g., REDIS for quick cached information and MongDB for historical data). Main associated methods are:<ul><li><code>putStorage(WldtStorage storage)</code>: Add a new WldtStorage to the StorageManager</li><li><code>getStorageIdList()</code>: Returns the list of id of the WldtStorage in the StorageManager</li><li><code>isStorageAvailable(String storageId)</code>: Checks if a target Storage Id is available in the Storage Manager</li><li><code>getStorage(String storageId)</code>: Get the target WldtStorage by id from the Storage Manager</li><li><code>removeStorage(String storageId)</code>: Remove an existing WldtStorage by id from the StorageManager</li></ul></li><li><code>WldtStorage</code>: Defines an abstract class allowing the Digital Twin developer to implement its internal storage system for the Digital Twin instance.<ul><li>The class defines methods for the management of:<ul><li>Digital Twin State storage and retrieval with the associated change list;</li></ul><ul><li>Generated State Digital Events;</li><li>Life Cycle State storage and retrieval;</li><li>Physical Asset Description storage and retrieval;</li><li>Physical Asset Property Variation storage and retrieval;</li><li>Physical Asset Relationship Instance storage and retrieval;</li><li>Digital Action Request storage and retrieval;</li><li>Physical Asset Action Request storage and retrieval;</li><li>Physical Asset Event Notification storage and retrieval;</li></ul></li></ul><ul><li>Each WldtStorage instance can be configured (using the right constructor method) to:<ul><li>Observe all Wldt events (<code>stateEvents</code>, <code>physicalAssetEvents</code>, <code>physicalAssetActionEvents</code>, <code>physicalAssetDescriptionEvents</code>, <code>digitalActionEvents</code>, <code>lifeCycleEvents</code>)</li><li>Filter only for specific class of events</li><li>Once the WldtStorage has been properly configured to receive target events the <code>StorageManager</code> automatically save information of interest for that specific storage. For example we can have a <code>StorageA</code> (e.g, REDIS) configured to receive all the generated events and a <code>StorageB</code> (e.g., MongoDB) in charge of saving only DT&rsquo;s state variation over time.</li></ul></li><li>The default implementation of the <code>WldtStorage</code> is the class <code>DefaultWldtStorage</code>. This class provides a simple storage solution for digital twin states, digital twin state changes, physical asset events, and digital twin events. The class provides <strong>ONLY</strong> a memory based approach for storage using ArrayLists and HashMaps and more advanced solution should be implemented for production oriented Digital Twins for examples using external storage and memorization solutions.</li><li>Methods available and implemented by WldtStorage implementations are the following grouped by categories:<ul><li><strong>Digital Twin State</strong>:<ul><li><code>saveDigitalTwinState(DigitalTwinState digitalTwinState, List&lt;DigitalTwinStateChange> digitalTwinStateChangeList)</code>: Save a new computed instance of the DT State in the Storage together with the list of the changes with respect to the previous state</li><li><code>getLastDigitalTwinState()</code>: Returns the latest computed Digital Twin State of the target Digital Twin instance</li><li><code>getDigitalTwinStateCount()</code>: Returns the number of computed and stored Digital Twin States</li><li><code>getDigitalTwinStateInTimeRange(long startTimestampMs, long endTimestampMs)</code>: Retrieves a list of DigitalTwinState objects within the specified time range</li><li><code>getDigitalTwinStateInRange(int startIndex, int endIndex)</code>: Retrieves a list of Digital Twin states within the specified range of indices</li></ul></li><li><strong>Digital Twin State Event Notification</strong>:<ul><li><code>saveDigitalTwinStateEventNotification(DigitalTwinStateEventNotification&lt;?> digitalTwinStateEventNotification)</code>: Save the Digital Twin State Event Notification</li><li><code>getDigitalTwinStateEventNotificationCount()</code>: Get the number of Digital Twin State Event Notification</li><li><code>getDigitalTwinStateEventNotificationInTimeRange(long startTimestampMs, long endTimestampMs)</code>: Get the Digital Twin State Event Notification in the specified time range</li><li><code>getDigitalTwinStateEventNotificationInRange(int startIndex, int endIndex)</code>: Get the Digital Twin State Event Notification in the specified range of indices</li></ul></li><li><strong>Life Cycle State Variation</strong>:<ul><li><code>saveLifeCycleState(LifeCycleStateVariation lifeCycleStateVariation)</code>: Save the LifeCycleState of the Digital Twin</li><li><code>getLastLifeCycleState()</code>: Get the last LifeCycleState of the Digital Twin</li><li><code>getLifeCycleStateCount()</code>: Get the number of LifeCycleState of the Digital Twin</li><li><code>getLifeCycleStateInTimeRange(long startTimestampMs, long endTimestampMs)</code>: Get the last LifeCycleState of the Digital Twin</li><li><code>getLifeCycleStateInRange(int startIndex, int endIndex)</code>: Get the LifeCycleState of the Digital Twin in the specified range of indices</li></ul></li><li><strong>Physical Asset Event Notification</strong>:<ul><li><code>savePhysicalAssetEventNotification(PhysicalAssetEventNotification physicalAssetEventNotification)</code>: Save the Physical Asset Event Notification</li><li><code>getPhysicalAssetEventNotificationCount()</code>: Get the number of Physical Asset Event Notification</li><li><code>getPhysicalAssetEventNotificationInTimeRange(long startTimestampMs, long endTimestampMs)</code>: Get the Physical Asset Event Notification in the specified time range</li><li><code>getPhysicalAssetEventNotificationInRange(int startIndex, int endIndex)</code>: Get the Physical Asset Event Notification in the specified range of indices</li></ul></li><li><strong>Physical Action Request</strong>:<ul><li><code>savePhysicalAssetActionRequest(PhysicalAssetActionRequest physicalAssetActionRequest)</code>: Save Physical Asset Action Request</li><li><code>getPhysicalAssetActionRequestCount()</code>: Get the number of Physical Asset Action Request</li><li><code>getPhysicalAssetActionRequestInTimeRange(long startTimestampMs, long endTimestampMs)</code>: Get the Physical Asset Action Request in the specified time range</li><li><code>getPhysicalAssetActionRequestInRange(int startIndex, int endIndex)</code>: Get the Physical Asset Action Request in the specified range of indices</li></ul></li><li><strong>Digital Action Request</strong>:<ul><li><code>saveDigitalActionRequest(DigitalActionRequest digitalActionRequest)</code>: Save a Digital Action Request</li><li><code>getDigitalActionRequestCount()</code>: Get the number of Digital Action Request Stored</li><li><code>getDigitalActionRequestInTimeRange(long startTimestampMs, long endTimestampMs)</code>: Get the Digital Action Request in the specified time range</li><li><code>getDigitalActionRequestInRange(int startIndex, int endIndex)</code>: Get the Digital Action Request in the specified range of indices</li></ul></li><li><strong>Physical Asset Description (PAD) Notification</strong><ul><li>New PAD Notification<ul><li><code>saveNewPhysicalAssetDescriptionNotification(PhysicalAssetDescriptionNotification physicalAssetDescriptionNotification)</code>: Save a new Physical Asset Description Available</li><li><code>getNewPhysicalAssetDescriptionNotificationCount()</code>: Get the number of New Physical Asset Description Notifications available</li><li><code>getNewPhysicalAssetDescriptionNotificationInTimeRange(long startTimestampMs, long endTimestampMs)</code>: Get the New Physical Asset Description Available in the specified time range</li><li><code>getNewPhysicalAssetDescriptionNotificationInRange(int startIndex, int endIndex)</code>: Get the New Physical Asset Description Available in the specified range of indices</li></ul></li><li>Updated PAD Notification<ul><li><code>saveUpdatedPhysicalAssetDescriptionNotification(PhysicalAssetDescriptionNotification physicalAssetDescriptionNotification)</code>: Save the updated Physical Asset Description Notification</li><li><code>getUpdatedPhysicalAssetDescriptionNotificationCount()</code>: Get the number of Updated Physical Asset Description</li><li><code>getUpdatedPhysicalAssetDescriptionNotificationInTimeRange(long startTimestampMs, long endTimestampMs)</code>: Get the Updated Physical Asset Description in the specified time range</li><li><code>getUpdatedPhysicalAssetDescriptionNotificationInRange(int startIndex, int endIndex)</code>: Get the Updated Physical Asset Description in the specified range of indices</li></ul></li></ul></li><li><strong>Physical Asset Property Variation</strong>:<ul><li><code>savePhysicalAssetPropertyVariation(PhysicalAssetPropertyVariation physicalAssetPropertyVariation)</code>: Save the Physical Asset Property Variation</li><li><code>getPhysicalAssetPropertyVariationCount()</code>: Get the number of Physical Asset Property Variation</li><li><code>getPhysicalAssetPropertyVariationInTimeRange(long startTimestampMs, long endTimestampMs)</code>: Get the Physical Asset Property Variation in the specified time range</li><li><code>getPhysicalAssetPropertyVariationInRange(int startIndex, int endIndex)</code>: Get the Physical Asset Property Variation in the specified range of indices</li></ul></li><li><strong>Physical Asset Relationship Instance Notification</strong><ul><li>Created Relationship Instance<ul><li><code>savePhysicalAssetRelationshipInstanceCreatedNotification(PhysicalRelationshipInstanceVariation physicalRelationshipInstanceVariation)</code>: Save the Physical Asset Relationship Instance Created Event</li><li><code>getPhysicalAssetRelationshipInstanceCreatedNotificationCount()</code>: Get the number of Physical Asset Relationship Instance Created Event</li><li><code>getPhysicalAssetRelationshipInstanceCreatedNotificationInTimeRange(long startTimestampMs, long endTimestampMs)</code>: Get the Physical Asset Relationship Instance Created Event in the specified time range</li><li><code>getPhysicalAssetRelationshipInstanceCreatedNotificationInRange(int startIndex, int endIndex)</code>: Get the Physical Asset Relationship Instance Created Event in the specified range of indices</li></ul></li><li>Deleted Relationship Instance<ul><li><code>savePhysicalAssetRelationshipInstanceDeletedNotification(PhysicalRelationshipInstanceVariation physicalRelationshipInstanceVariation)</code>: Save the Physical Asset Relationship Instance Updated Event</li><li><code>getPhysicalAssetRelationshipInstanceDeletedNotificationCount()</code>: Get the number of Physical Asset Relationship Instance Updated Event</li><li><code>getPhysicalAssetRelationshipInstanceDeletedNotificationInTimeRange(long startTimestampMs, long endTimestampMs)</code>: Get the Physical Asset Relationship Instance Updated Event in the specified time range</li><li><code>getPhysicalAssetRelationshipInstanceDeletedNotificationInRange(int startIndex, int endIndex)</code>: Get the Physical Asset Relationship Instance Updated Event in the specified range of indices</li></ul></li></ul></li></ul></li></ul></li></ul><p>Some examples of usage for the Storage Layer are the following:</p><p>Lets&rsquo; create a new Digital Twin with a single Storage in charge of <em>automatically</em> observe and store all the event generated and going through the target DT instance</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=c1>// Create the Digital Twin Engine
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>DigitalTwinEngine</span> <span class=n>digitalTwinEngine</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DigitalTwinEngine</span><span class=o>();</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Create a new Digital Twin with a Demo Shadowing Function
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>DigitalTwin</span> <span class=n>digitalTwin</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DigitalTwin</span><span class=o>(</span><span class=n>TEST_DIGITAL_TWIN_ID</span><span class=o>,</span> <span class=k>new</span> <span class=n>DemoShadowingFunction</span><span class=o>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Physical Adapter Configuration  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>DemoPhysicalAdapter</span> <span class=n>physicalAdapter</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DemoPhysicalAdapter</span><span class=o>(...);</span>  
</span></span><span class=line><span class=cl><span class=n>digitalTwin</span><span class=o>.</span><span class=na>addPhysicalAdapter</span><span class=o>(</span><span class=n>physicalAdapter</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Digital Adapter Configuration
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>digitalAdapter</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DemoDigitalAdapter</span><span class=o>(...);</span>  
</span></span><span class=line><span class=cl><span class=n>digitalTwin</span><span class=o>.</span><span class=na>addDigitalAdapter</span><span class=o>(</span><span class=n>digitalAdapter</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Create a new WldtStorage instance using the default implementation and observing all the events  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>DefaultWldtStorage</span> <span class=n>myStorage</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DefaultWldtStorage</span><span class=o>(</span><span class=s>&#34;test_storage&#34;</span><span class=o>,</span> <span class=kc>true</span><span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Add the new Default Storage Instance to the Digital Twin Storage Manager 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>digitalTwin</span><span class=o>.</span><span class=na>getStorageManager</span><span class=o>().</span><span class=na>putStorage</span><span class=o>(</span><span class=n>myStorage</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Add the Twin to the Engine  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>digitalTwinEngine</span><span class=o>.</span><span class=na>addDigitalTwin</span><span class=o>(</span><span class=n>digitalTwin</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=c1>// Start the Digital Twin  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>digitalTwinEngine</span><span class=o>.</span><span class=na>startDigitalTwin</span><span class=o>(</span><span class=n>TEST_DIGITAL_TWIN_ID</span><span class=o>);</span>
</span></span></code></pre></div><p>Now let&rsquo;s <strong>suppose</strong> to have two additional implementation of the WldtStorage class supporting Redis and MongDB and called <code>RedisWldtStorage</code> and <code>MongoDbWldtStorage</code>.
We would like to use Redis to <em>automatically</em> observe all the events and MongoDb only to store DT&rsquo;s state and life cycle variations.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=o>[...]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Create a new RedisWldtStorage instance using the default implementation and observing all the events  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>RedisWldtStorage</span> <span class=n>myRedisStorage</span> <span class=o>=</span> <span class=k>new</span> <span class=n>RedisWldtStorage</span><span class=o>(</span><span class=s>&#34;redis_storage&#34;</span><span class=o>,</span> <span class=kc>true</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>myRedisStorage</span><span class=o>.</span><span class=na>setRedisConfiguration</span><span class=o>(</span><span class=n>myRedisConfiguration</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Add the new Redis Storage Instance to the Digital Twin Storage Manager 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>digitalTwin</span><span class=o>.</span><span class=na>getStorageManager</span><span class=o>().</span><span class=na>putStorage</span><span class=o>(</span><span class=n>myRedisStorage</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Create a new MongoDbWldtStorage instance using the default implementation and observing only State and LifeCycle Events
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>MongoDbWldtStorage</span> <span class=n>myMongoDbStorage</span> <span class=o>=</span> <span class=k>new</span> <span class=n>MongoDbWldtStorage</span><span class=o>(</span><span class=s>&#34;mongo_db_storage&#34;</span><span class=o>,</span> <span class=kc>true</span><span class=o>,</span> <span class=kc>false</span><span class=o>,</span> <span class=kc>false</span><span class=o>,</span> <span class=kc>false</span><span class=o>,</span> <span class=kc>false</span><span class=o>,</span> <span class=kc>true</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>myMongoDbStorage</span><span class=o>.</span><span class=na>setMongoDbConfiguration</span><span class=o>(</span><span class=n>myMongoDbConfiguration</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Add the new MongoDb Storage Instance to the Digital Twin Storage Manager 
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>digitalTwin</span><span class=o>.</span><span class=na>getStorageManager</span><span class=o>().</span><span class=na>putStorage</span><span class=o>(</span><span class=n>myRedisStorage</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[...]</span>
</span></span></code></pre></div><p>Within the <code>ShadowingFunction</code> it is possible to have the reference to the <code>StorageManager</code> in order to access available Storage in both reading and writing mode.
This is an example of how to retrieve an available WldtStorage through its id and the use it to read Properties values in a time range of the last 5 minutes:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>String</span> <span class=n>TARGET_STORAGE_ID</span> <span class=o>=</span> <span class=s>&#34;test_storage&#34;</span><span class=o>;</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=k>if</span><span class=o>(</span><span class=k>this</span><span class=o>.</span><span class=na>storageManager</span><span class=o>.</span><span class=na>isStorageAvailable</span><span class=o>(</span><span class=n>TARGET_STORAGE_ID</span><span class=o>)){</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>    <span class=c1>// Access the Storage Manager to store the last value of the property  
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>WldtStorage</span> <span class=n>targetStorage</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>storageManager</span><span class=o>.</span><span class=na>getStorage</span><span class=o>(</span><span class=n>TARGET_STORAGE_ID</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>    <span class=c1>// Get the current time in milliseconds  
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>long</span> <span class=n>endTime</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=na>currentTimeMillis</span><span class=o>();</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>    <span class=c1>// Get the Time in the last 5 minutes  
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>long</span> <span class=n>startTime</span> <span class=o>=</span> <span class=n>endTime</span> <span class=o>-</span> <span class=o>(</span><span class=mi>5</span> <span class=o>*</span> <span class=mi>60</span> <span class=o>*</span> <span class=mi>1000</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>    <span class=c1>// Get the last Physical Asset Action Request in the last 5 minutes  
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>List</span><span class=o>&lt;</span><span class=n>PhysicalAssetPropertyVariationRecord</span><span class=o>&gt;</span> <span class=n>propertyVariationRecords</span> <span class=o>=</span> <span class=n>targetStorage</span><span class=o>.</span><span class=na>getPhysicalAssetPropertyVariationInTimeRange</span><span class=o>(</span><span class=n>startTime</span><span class=o>,</span> <span class=n>endTime</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=o>(</span><span class=n>PhysicalAssetPropertyVariationRecord</span> <span class=n>propertyVariationRecord</span> <span class=o>:</span> <span class=n>propertyVariationRecords</span><span class=o>){</span>  
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=na>info</span><span class=o>(</span><span class=s>&#34;Property Variation Record: {}&#34;</span><span class=o>,</span> <span class=n>propertyVariationRecord</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>        <span class=o>[...]</span>  
</span></span><span class=line><span class=cl>    <span class=o>}</span>  
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p><strong>Note</strong>: The <code>StorageManager</code>, as previously described, can automatically store DT-related events based on the configuration and setup of each <code>WldtStorage</code> instance added to the manager. However, since the <code>ShadowingFunction</code> has direct access to the <code>StorageManager</code> in both read and write modes, manual handling of data storage is also possible. To achieve this, you can disable automatic storage by setting it to <code>false</code> for specific event types or for all event types. This allows you to manually manage the storage of information within the <code>ShadowingFunction</code>.</p><h4 id=query-system>Query System<a href=#query-system class=anchor aria-hidden=true>#</a></h4><p>Given the library&rsquo;s goal of maximizing modularity and decoupling responsibilities among the available components, the <strong>Query System</strong> has been introduced. This system allows components external to the core responsibilities of the Digital Twin (e.g., Digital Adapters and Augmentation Functions) to retrieve stored data and use or expose it according to their specific logic and implementation. For instance, an HTTP Digital Adapter could expose stored information about a DT&rsquo;s state variations over time, or a Monitoring Adapter could use available storage instances to retrieve events for a deeper understanding of the target DT instance&rsquo;s behavior. The query system has been implemented entirely through dedicated events in order to maximize the decoupling of the solution and and supports at the same time both <strong>synchronous</strong> and <strong>asynchronous</strong> queries.</p><p>The main classes associated to the Query System are the following:</p><ul><li><code>QueryManager</code>: This class represents the Query Manager responsible to handle the query request and manage the query execution and has been designed to be extended by the user to implement the desired query management logic (e.g., as with the <code>DefaultQueryManager</code>).</li><li><code>QueryRequest</code>: The class contains all the information needed to perform a query on the storage system</li><li><code>QueryRequestType</code>: This Enum represents the Query Request Type used to specify the type of query to be performed on the storage system supporting:<ul><li>TIME_RANGE</li><li>SAMPLE_RANGE</li><li>LAST_VALUE</li><li>COUNT</li></ul></li><li><code>QueryResourceType</code>: This Enum represents the Query Resource Type used to specify the type of resource to be queried on the storage system supporting the following resource types mapping those available and managed by the storage manager:<ul><li>PHYSICAL_ASSET_PROPERTY_VARIATION</li><li>PHYSICAL_ASSET_EVENT_NOTIFICATION</li><li>PHYSICAL_ACTION_REQUEST</li><li>DIGITAL_ACTION_REQUEST</li><li>DIGITAL_TWIN_STATE</li><li>NEW_PAD_NOTIFICATION</li><li>UPDATED_PAD_NOTIFICATION</li><li>PHYSICAL_RELATIONSHIP_INSTANCE_CREATED_NOTIFICATION</li><li>PHYSICAL_RELATIONSHIP_INSTANCE_DELETED_NOTIFICATION</li><li>LIFE_CYCLE_EVENT</li></ul></li><li><code>QueryExecutor</code>: This class represents the Query Executor used to execute queries on the storage system supporting both synchronous and asynchronous query execution. Internally is implemented through an event-based mechanism to handle the query request and response</li><li><code>QueryResult</code>: This class represents the Query Result returned by the Query Executor containing the query results and the query status (successful or not) and error message (if any) together with also the original request</li><li><code>IQueryResultListener</code>: This interface represents the Query Result Listener used to receive the query results</li></ul><p>An example of Synchronous query is:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>QueryExecutor</span> <span class=n>queryExecutor</span> <span class=o>=</span> <span class=k>new</span> <span class=n>QueryExecutor</span><span class=o>(</span><span class=n>TEST_DIGITAL_TWIN_ID</span><span class=o>,</span> <span class=s>&#34;query-executor&#34;</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=c1>// Create Query Request to the Storage Manager for the Last Digital Twin State  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>QueryRequest</span> <span class=n>queryRequest</span> <span class=o>=</span> <span class=k>new</span> <span class=n>QueryRequest</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=n>queryRequest</span><span class=o>.</span><span class=na>setResourceType</span><span class=o>(</span><span class=n>QueryResourceType</span><span class=o>.</span><span class=na>DIGITAL_TWIN_STATE</span><span class=o>);</span>  
</span></span><span class=line><span class=cl><span class=n>queryRequest</span><span class=o>.</span><span class=na>setRequestType</span><span class=o>(</span><span class=n>QueryRequestType</span><span class=o>.</span><span class=na>LAST_VALUE</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=c1>// Send the Query Request to the Storage Manager for the target DT  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>QueryResult</span><span class=o>&lt;?&gt;</span> <span class=n>queryResult</span> <span class=o>=</span> <span class=n>queryExecutor</span><span class=o>.</span><span class=na>syncQueryExecute</span><span class=o>(</span><span class=n>queryRequest</span><span class=o>);</span>
</span></span></code></pre></div><p>Following the same approach an Asynchrounouse query can be executed as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>QueryExecutor</span> <span class=n>queryExecutor</span> <span class=o>=</span> <span class=k>new</span> <span class=n>QueryExecutor</span><span class=o>(</span><span class=n>TEST_DIGITAL_TWIN_ID</span><span class=o>,</span> <span class=s>&#34;query-executor&#34;</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl><span class=c1>// Create Query Request to the Storage Manager for the Last Digital Twin State  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>QueryRequest</span> <span class=n>queryRequest</span> <span class=o>=</span> <span class=k>new</span> <span class=n>QueryRequest</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=n>queryRequest</span><span class=o>.</span><span class=na>setResourceType</span><span class=o>(</span><span class=n>QueryResourceType</span><span class=o>.</span><span class=na>DIGITAL_TWIN_STATE</span><span class=o>);</span>  
</span></span><span class=line><span class=cl><span class=n>queryRequest</span><span class=o>.</span><span class=na>setRequestType</span><span class=o>(</span><span class=n>QueryRequestType</span><span class=o>.</span><span class=na>LAST_VALUE</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl><span class=c1>// Send the Query Request to the Storage Manager for the target DT  
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>queryExecutor</span><span class=o>.</span><span class=na>asyncQueryExecute</span><span class=o>(</span><span class=n>queryRequest</span><span class=o>,</span> <span class=k>new</span> <span class=n>IQueryResultListener</span><span class=o>()</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>  
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>onQueryResult</span><span class=o>(</span><span class=n>QueryResult</span><span class=o>&lt;?&gt;</span> <span class=n>queryResult</span><span class=o>)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>        <span class=o>[...]</span>  
</span></span><span class=line><span class=cl>    <span class=o>}</span>  
</span></span><span class=line><span class=cl><span class=o>});</span>
</span></span></code></pre></div><p>The class <code>DigitalAdapter</code> has been updated adding also an internal reference to a <code>QueryExecutor</code> in order to simplify the interaction with the query system directly from an adapter like in the following example where we use the query Executor of the Digital Adapter <code>invokeAction</code> callback through its internal variable accessible through <code>this.queryExecutor</code> without creating a new executor:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=o>&lt;</span><span class=n>T</span><span class=o>&gt;</span> <span class=kt>void</span> <span class=nf>invokeAction</span><span class=o>(</span><span class=n>String</span> <span class=n>actionKey</span><span class=o>,</span> <span class=n>T</span> <span class=n>body</span><span class=o>){</span>  
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>          
</span></span><span class=line><span class=cl>        <span class=c1>// Create Query Request to the Storage Manager for the Last Digital Twin State  
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>QueryRequest</span> <span class=n>queryRequest</span> <span class=o>=</span> <span class=k>new</span> <span class=n>QueryRequest</span><span class=o>();</span>  
</span></span><span class=line><span class=cl>        <span class=n>queryRequest</span><span class=o>.</span><span class=na>setResourceType</span><span class=o>(</span><span class=n>QueryResourceType</span><span class=o>.</span><span class=na>DIGITAL_TWIN_STATE</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>        <span class=n>queryRequest</span><span class=o>.</span><span class=na>setRequestType</span><span class=o>(</span><span class=n>QueryRequestType</span><span class=o>.</span><span class=na>LAST_VALUE</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>        <span class=c1>// Send the Query Request to the Storage Manager for the target DT  
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>QueryResult</span><span class=o>&lt;?&gt;</span> <span class=n>queryResult</span> <span class=o>=</span> <span class=k>this</span><span class=o>.</span><span class=na>queryExecutor</span><span class=o>.</span><span class=na>syncQueryExecute</span><span class=o>(</span><span class=n>queryRequest</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1>// Do Something with the Query Result  
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span><span class=o>(</span><span class=n>Object</span> <span class=n>result</span> <span class=o>:</span> <span class=n>queryResult</span><span class=o>.</span><span class=na>getResults</span><span class=o>()){</span>  
</span></span><span class=line><span class=cl>	        <span class=c1>// Check the type of the Resulting class accordingly to the query
</span></span></span><span class=line><span class=cl><span class=c1></span>		    <span class=k>if</span><span class=o>(</span><span class=n>result</span> <span class=k>instanceof</span> <span class=n>DigitalTwinState</span><span class=o>)</span>  
</span></span><span class=line><span class=cl>		        <span class=n>logger</span><span class=o>.</span><span class=na>info</span><span class=o>(</span><span class=s>&#34;LAST DT STATE: {}&#34;</span><span class=o>,</span> <span class=n>result</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>		    <span class=k>else</span>
</span></span><span class=line><span class=cl>			    <span class=n>logger</span><span class=o>.</span><span class=na>error</span><span class=o>(</span><span class=s>&#34;INVALID RESULT TYPE: {}&#34;</span><span class=o>,</span> <span class=n>result</span><span class=o>.</span><span class=na>getClass</span><span class=o>().</span><span class=na>getName</span><span class=o>());</span>  
</span></span><span class=line><span class=cl>		<span class=o>}</span>
</span></span><span class=line><span class=cl>          
</span></span><span class=line><span class=cl>        <span class=n>logger</span><span class=o>.</span><span class=na>info</span><span class=o>(</span><span class=s>&#34;INVOKING ACTION: {} BODY: {}&#34;</span><span class=o>,</span> <span class=n>actionKey</span><span class=o>,</span> <span class=n>body</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>        <span class=n>publishDigitalActionWldtEvent</span><span class=o>(</span><span class=n>actionKey</span><span class=o>,</span> <span class=n>body</span><span class=o>);</span>  
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>EventBusException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>        <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>  
</span></span><span class=line><span class=cl>    <span class=o>}</span>  
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=migration-info-030---040>Migration Info: 0.3.0 - 0.4.0<a href=#migration-info-030---040 class=anchor aria-hidden=true>#</a></h2><ul><li>Now <code>PhysicalAssetRelationship</code> constructor has also the <code>type</code> in order to match the <code>DigitalTwinStateRelationship</code> and simplify its management</li><li>The method <code>notifyDigitalTwinStateEvent</code> throws only the Exception <code>WldtDigitalTwinStateEventNotificationException</code> while <code>EventBusException</code> has been removed</li></ul><h2 id=additional-improvements--fixed-bugs>Additional Improvements & Fixed Bugs<a href=#additional-improvements--fixed-bugs class=anchor aria-hidden=true>#</a></h2><ul><li>Synchronized the update of the current DT Life Cycle State in order to avoid wrong data</li><li>The <code>WldtEventBus</code> now supports the use of topics Wildcard (at the moment only multi-level with the character <code>*</code>). For example with this approach is possible to subscribe to all the events associated to property variations (topic: <code>dt.physical.event.property.*</code>). New methods added to <code>WldtEventBus</code> are:<ul><li><code>matchWildCardType(String eventType, String filterType)</code>: Check if the provided event type match the WildCard Type</li><li><code>isWildCardType(String filterEventType)</code>: Check if the provided event type is a WildCard Type</li></ul></li><li>The class <code>WldtEventTypes</code> has been introduced to contain all the event types in the WLDT Framework and support internal message exchange. Includes types for events associated and adopted by: i) Physical Adapters; ii) Model and Shadowing Function; and iii) Digital Adapters.</li><li>The <code>EventManager</code> class has been added to centralize and simplify the event management in the WLDT Framework providing a set of static methods to publish events associated to a target digital twin and publisher (e.g., the physical adapter of the twin).</li><li>Now <code>PhysicalAssetRelationship</code> class has also the <code>type</code> in order to match the <code>DigitalTwinStateRelationship</code> and simplify its management</li><li>The internal class <code>ModelEngine</code> has been renamed into <code>DigitalTwinModel</code> as an initial update for further development of the next version 0.5.0 where the structure of the DT&rsquo;s Model and the associated classes will be improved</li></ul><div class="page-footer-meta d-flex flex-column flex-md-row justify-content-between"><div class=last-modified><a href=https://github.com/wldt/wldt.github.io/commit/048a15b762a6acf542e0f0612c0a4f0c63855306><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Last updated on September 5, 2024</a></div><div class=edit-page><a href=https://github.com/wldt/wldt.github.io/blob/main/content//docs/change-logs/change-log-0.4.0.md><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-edit-2"><path d="M17 3a2.828 2.828.0 114 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>Edit this page on GitHub</a></div></div><div class="page-nav d-flex flex-column flex-sm-row"><div class="card w-100"><div class="card-body d-flex"><div class="d-flex flex-column justify-content-center"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-arrow-left" width="20" height="20" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12h14"/><path d="M5 12l6 6"/><path d="M5 12l6-6"/></svg></div><div class="d-flex flex-column"><div class=text-body-secondary>Prev</div><a href=https://wldt.github.io/docs/guides/storage-layer/ class="stretched-link text-reset text-decoration-none">Storage Layer</a></div></div></div></div></main></div></div></div><footer class="footer text-muted"><div class=container-lg><div class=row><div class="col-lg-8 text-center text-lg-start"><ul class=list-inline><li class=list-inline-item><a class=text-muted href=https://wldt.github.io/privacy/>Privacy Policy</a></li></ul></div><div class="col-lg-8 text-center text-lg-end"><ul class=list-inline><li class=list-inline-item>Brought to you by <a class=text-muted href=https://gethyas.com/>Hyas</a></li></ul></div></div></div></footer><script async src=https://wldt.github.io/js/app.1e84dcdaa5ccef6fe83f6d88ac1e444a1f237111cfa2a7a97427f758e9c27ef4.js integrity="sha256-HoTc2qXM72/oP22IrB5ESh8jcRHPoqepdCf3WOnCfvQ="></script>
<script async src=https://wldt.github.io/js/flexsearch.dc00caef2c3490dbab3c345ed0d4133b0aafb803efeb21c3df80776d6d3ea821.js integrity="sha256-3ADK7yw0kNurPDRe0NQTOwqvuAPv6yHD34B3bW0+qCE="></script><script async src=https://wldt.github.io/js/search-modal.c4c023efcdee308e4b5f1110afe1db6b1656f217e67aa7efe54e2f4bf2feccf8.js integrity="sha256-xMAj783uMI5LXxEQr+HbaxZW8hfmeqfv5U4vS/L+zPg="></script><div class="d-inline-flex fixed-bottom-right pb-4 pe-4"><button id=toTop type=button class="btn btn-primary rounded-circle ms-auto p-2"><span class=visually-hidden>Top</span><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-chevron-up" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 15l6-6 6 6"/></svg></button></div></body></html>